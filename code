import pandas as pd
import numpy as np
from tensorflow.keras.utils import to_categorical
from tensorflow.keras.preprocessing.image import load_img, img_to_array

# Load CSV
test_df = pd.read_csv("path_to_test_csv.csv")  # replace with your CSV path

# Parameters
target_size = (64, 64)  # or whatever your model expects
label_column = "ClassId"
path_column = "Path"

# Load images
X_test = []
y_test = []

for idx, row in test_df.iterrows():
    try:
        img = load_img(row[path_column], target_size=target_size)
        X_test.append(img_to_array(img))
        y_test.append(row[label_column])
    except Exception as e:
        print(f"Skipping {row[path_column]}: {e}")

X_test = np.array(X_test, dtype="float32") / 255.0
y_test = to_categorical(np.array(y_test))
